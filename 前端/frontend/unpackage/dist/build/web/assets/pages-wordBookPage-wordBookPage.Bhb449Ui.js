import{k as e,r as t,s as o,d as s,w as a,i as d,o as l,l as i,m as c,e as u,f as n,t as p,p as r,F as h,g as k,h as f,j as m,I as b,u as _,x as I}from"./index-iGyM-cqh.js";import{_ as B}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=B({data:()=>({wordBooks:[],defaultWordBookId:null,editItem:{id:null,name:"",description:"",isPublic:0},currentDesc:"",showEditPopup:!1,showDescPopup:!1,token:e("token")}),methods:{async fetchWordBooks(){const e=await t({url:"http://localhost:9192/wordBook/getWordBookByUserId",method:"GET",header:{token:this.token}});1===e.data.code&&(this.wordBooks=e.data.data)},async fetchDefaultWordBook(){const e=await t({url:"http://localhost:9192/user/getDefaultWordBookIdByCurrentID",method:"GET",header:{token:this.token}});1===e.data.code&&(this.defaultWordBookId=e.data.data)},async setDefault(e){1===(await t({url:`http://localhost:9192/user/updateDefaultWordBookId?wordBookId=${e}`,method:"PUT",header:{token:this.token}})).data.code&&(this.defaultWordBookId=e,o({title:"设置成功",icon:"success"}))},openEditPopup(e){this.editItem={...e},this.showEditPopup=!0},toggleCheckbox(e){this.editItem.isPublic!==e&&(this.editItem.isPublic=e)},async updateWordBook(){1===(await t({url:"http://localhost:9192/wordBook/update",method:"PUT",header:{token:this.token},data:{id:this.editItem.id,name:this.editItem.name,description:this.editItem.description,isPublic:this.editItem.isPublic}})).data.code&&(o({title:"修改成功",icon:"success"}),this.showEditPopup=!1,this.fetchWordBooks())},async confirmDelete(e){1===(await t({url:`http://localhost:9192/wordBook/delete/${e}`,method:"DELETE",header:{token:this.token}})).data.code&&(o({title:"删除成功",icon:"success"}),this.fetchWordBooks())},showDescription(e){this.currentDesc=e,this.showDescPopup=!0},closeEditPopup(){this.showEditPopup=!1},closeDescPopup(){this.showDescPopup=!1},truncate:e=>e.length>10?e.substring(0,10)+"...":e},onLoad(){this.fetchWordBooks(),this.fetchDefaultWordBook()}},[["render",function(e,t,o,B,w,P){const D=f,C=m,W=d,g=b,E=_,x=I;return l(),s(W,{class:"container"},{default:a((()=>[(l(!0),i(h,null,c(w.wordBooks,(e=>(l(),s(W,{class:"wordbook-item",key:e.id},{default:a((()=>[u(D,{class:"id"},{default:a((()=>[n(p(e.id),1)])),_:2},1024),u(D,{class:"title",onClick:t=>P.showDescription(e.description)},{default:a((()=>[n(p(P.truncate(e.name)),1)])),_:2},1032,["onClick"]),u(D,{class:"desc"},{default:a((()=>[n(p(P.truncate(e.description)),1)])),_:2},1024),u(C,{class:r(["btn default-btn",{active:e.id===w.defaultWordBookId}]),onClick:t=>P.setDefault(e.id)},{default:a((()=>[n(p(e.id===w.defaultWordBookId?"默认":"设为默认"),1)])),_:2},1032,["class","onClick"]),u(C,{class:"btn edit-btn",onClick:t=>P.openEditPopup(e)},{default:a((()=>[n("修改")])),_:2},1032,["onClick"]),u(C,{class:r(["btn delete-btn",{disabled:e.id===w.defaultWordBookId}]),disabled:e.id===w.defaultWordBookId,onClick:t=>P.confirmDelete(e.id)},{default:a((()=>[n(" 删除 ")])),_:2},1032,["class","disabled","onClick"])])),_:2},1024)))),128)),w.showEditPopup?(l(),s(W,{key:0,class:"popup-overlay"},{default:a((()=>[u(W,{class:"popup-container"},{default:a((()=>[u(W,{class:"popup-title"},{default:a((()=>[n("修改词书")])),_:1}),u(g,{modelValue:w.editItem.name,"onUpdate:modelValue":t[0]||(t[0]=e=>w.editItem.name=e),placeholder:"请输入名称",class:"popup-input",maxlength:"10"},null,8,["modelValue"]),u(g,{modelValue:w.editItem.description,"onUpdate:modelValue":t[1]||(t[1]=e=>w.editItem.description=e),placeholder:"请输入描述",class:"popup-input",maxlength:"10"},null,8,["modelValue"]),u(W,{class:"checkbox-group"},{default:a((()=>[u(x,null,{default:a((()=>[u(E,{value:1,checked:1===w.editItem.isPublic,onClick:t[2]||(t[2]=e=>P.toggleCheckbox(1))},{default:a((()=>[u(D,{class:"checkbox-label"},{default:a((()=>[n("公开")])),_:1})])),_:1},8,["checked"]),u(E,{value:0,checked:0===w.editItem.isPublic,onClick:t[3]||(t[3]=e=>P.toggleCheckbox(0))},{default:a((()=>[u(D,{class:"checkbox-label"},{default:a((()=>[n("私密")])),_:1})])),_:1},8,["checked"])])),_:1})])),_:1}),u(C,{class:"register-btn",onClick:P.updateWordBook},{default:a((()=>[n("确认修改")])),_:1},8,["onClick"]),u(W,{class:"close-btn",onClick:P.closeEditPopup},{default:a((()=>[n("×")])),_:1},8,["onClick"])])),_:1})])),_:1})):k("",!0),w.showDescPopup?(l(),s(W,{key:1,class:"popup-overlay"},{default:a((()=>[u(W,{class:"popup-container"},{default:a((()=>[u(W,{class:"popup-title"},{default:a((()=>[n("词书描述")])),_:1}),u(D,null,{default:a((()=>[n(p(w.currentDesc),1)])),_:1}),u(C,{class:"register-btn",onClick:P.closeDescPopup},{default:a((()=>[n("关闭")])),_:1},8,["onClick"])])),_:1})])),_:1})):k("",!0)])),_:1})}],["__scopeId","data-v-5ecc903b"]]);export{w as default};
