import{r as e,k as t,s as o,H as a,d as l,w as i,i as s,o as n,e as d,f as c,l as u,m as r,t as h,F as p,p as m,g,E as f,G as C,D as k,I as b,j as _,h as y,u as T,x as F}from"./index-iGyM-cqh.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=V({data:()=>({query:{title:"",page:1,pageSize:10,wordBookId:1},total:0,records:[],currentPage:1,totalPages:1,permission:"READ",detailVisible:!1,detailData:{},editVisible:!1,editForm:{id:null,title:"",questionType:"单选题",category:"",note:"",status:"1",correctChoice:"",options:[{optionLabel:"A",optionText:""},{optionLabel:"B",optionText:""},{optionLabel:"C",optionText:""},{optionLabel:"D",optionText:""}]},selectedChoices:[]}),methods:{search(){this.query.page=1,this.getData()},getPermission(){e({url:"http://localhost:9192/user/getPermission",method:"GET",header:{token:t("token")},success:e=>{1===e.data.code?this.permission=e.data.data:o({title:"权限加载失败",icon:"none"})},fail:()=>{o({title:"网络错误",icon:"none"})}})},changePage(e){e<1||e>this.totalPages||(this.currentPage=e,this.query.page=e,this.getData())},deleteItem(l){const i=this;a({title:"删除确认",content:"确定要删除此题目吗？",success:function(a){a.confirm&&e({url:`http://localhost:9192/question/delete/${l}`,method:"DELETE",header:{token:t("token")},success:function(e){1===e.data.code?(o({title:"删除成功",icon:"success"}),i.getData()):o({title:"删除失败",icon:"none"})},fail:function(){o({title:"网络错误",icon:"none"})}})}})},getWordBookId(){e({url:"http://localhost:9192/user/getDefaultWordBookIdByCurrentID",method:"GET",header:{token:t("token")},success:e=>{1===e.data.code?(this.query.wordBookId=e.data.data,this.getData()):o({title:"加载失败",icon:"none"})},fail:()=>{o({title:"网络错误",icon:"none"})}})},clearForm(){this.editForm={id:null,title:"",questionType:"单选题",category:"",note:"",status:"1",correctChoice:"",options:[{optionLabel:"A",optionText:""},{optionLabel:"B",optionText:""},{optionLabel:"C",optionText:""},{optionLabel:"D",optionText:""}]},this.selectedChoices=[]},getData(){e({url:"http://localhost:9192/question/page",method:"GET",header:{token:t("token")},data:this.query,success:e=>{if(1===e.data.code){const t=e.data.data;this.records=t.records,this.total=t.total,this.totalPages=Math.ceil(this.total/this.query.pageSize)}}})},showDetail(o){e({url:`http://localhost:9192/question/getQuestion/${o.id}`,method:"GET",header:{token:t("token")},success:e=>{1===e.data.code&&(this.detailData=e.data.data,this.detailVisible=!0)}})},editItem(o){e({url:`http://localhost:9192/question/getQuestion/${o.id}`,method:"GET",header:{token:t("token")},success:e=>{if(1===e.data.code){const t=e.data.data;this.editForm={id:t.id,title:t.title,questionType:t.questionType,category:t.category,note:t.note,status:t.status,correctChoice:t.correctChoice,options:t.options||[{optionLabel:"A",optionText:""},{optionLabel:"B",optionText:""},{optionLabel:"C",optionText:""},{optionLabel:"D",optionText:""}]},this.selectedChoices=t.correctChoice.split(","),this.editVisible=!0}}})},handleQuestionTypeChange(){var e;"单选题"===this.editForm.questionType?this.editForm.correctChoice=(null==(e=this.editForm.options[0])?void 0:e.optionLabel)||"":"多选题"===this.editForm.questionType&&(this.selectedChoices=[],this.editForm.correctChoice="")},handleCheckboxChange(e){this.selectedChoices=e.detail.value,this.editForm.correctChoice=this.selectedChoices.join(",")},updateItem(){const l=this.editForm.questionType;return"单选题"===l&&1!==this.selectedChoices.length?a({title:"提示",content:"单选题只能选择一个答案"}):"多选题"===l&&this.selectedChoices.length<2?a({title:"提示",content:"多选题至少选择两个答案"}):(this.editForm.correctChoice=this.selectedChoices.join(","),void e({url:"http://localhost:9192/question/update",method:"PUT",header:{token:t("token")},data:this.editForm,success:e=>{1===e.data.code&&(o({title:"修改成功",icon:"success"}),this.editVisible=!1,this.getData())}}))}},mounted(){this.getWordBookId(),this.getPermission()}},[["render",function(e,t,o,a,V,D){const q=b,x=_,P=s,L=y,I=T,v=F;return n(),l(P,{class:"container"},{default:i((()=>[d(P,{class:"search-bar"},{default:i((()=>[d(q,{modelValue:V.query.title,"onUpdate:modelValue":t[0]||(t[0]=e=>V.query.title=e),placeholder:"请输入标题关键词",class:"search-input",onConfirm:D.search},null,8,["modelValue","onConfirm"]),d(x,{onClick:D.search,class:"search-button"},{default:i((()=>[c("搜索")])),_:1},8,["onClick"])])),_:1}),V.records.length>0?(n(),l(P,{key:0,class:"result-list"},{default:i((()=>[(n(!0),u(p,null,r(V.records,((e,t)=>(n(),l(P,{key:t,class:"result-item"},{default:i((()=>[d(L,{class:"item-index"},{default:i((()=>[c(h((V.currentPage-1)*V.query.pageSize+t+1),1)])),_:2},1024),d(L,{onClick:t=>D.showDetail(e),class:"item-title"},{default:i((()=>[c(h(e.title),1)])),_:2},1032,["onClick"]),d(x,{onClick:t=>D.editItem(e),class:"item-button",disabled:"READ"===V.permission},{default:i((()=>[c("修改")])),_:2},1032,["onClick","disabled"]),d(x,{onClick:t=>D.deleteItem(e.id),class:"item-button",disabled:"READ"===V.permission},{default:i((()=>[c("删除")])),_:2},1032,["onClick","disabled"])])),_:2},1024)))),128))])),_:1})):(n(),l(P,{key:1,class:"no-data"},{default:i((()=>[c("暂无数据")])),_:1})),V.total>0?(n(),l(P,{key:2,class:"pagination"},{default:i((()=>[d(x,{onClick:t[1]||(t[1]=e=>D.changePage(V.currentPage-1)),disabled:1===V.currentPage},{default:i((()=>[c("上一页")])),_:1},8,["disabled"]),(n(!0),u(p,null,r(V.totalPages,(e=>(n(),l(P,{key:e,onClick:t=>D.changePage(e),class:"page-item"},{default:i((()=>[d(L,{class:m({active:V.currentPage===e})},{default:i((()=>[c(h(e),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128)),d(x,{onClick:t[2]||(t[2]=e=>D.changePage(V.currentPage+1)),disabled:V.currentPage===V.totalPages},{default:i((()=>[c("下一页")])),_:1},8,["disabled"])])),_:1})):g("",!0),V.detailVisible?(n(),l(P,{key:3,class:"detail-popup"},{default:i((()=>[d(P,{class:"detail-content"},{default:i((()=>[d(L,null,{default:i((()=>[c("标题: "+h(V.detailData.title),1)])),_:1}),d(L,null,{default:i((()=>[c("题型: "+h(V.detailData.questionType),1)])),_:1}),d(L,null,{default:i((()=>[c("分类: "+h(V.detailData.category),1)])),_:1}),d(L,null,{default:i((()=>[c("正确答案: "+h(V.detailData.correctChoice),1)])),_:1}),(n(!0),u(p,null,r(V.detailData.options,((e,t)=>(n(),l(P,{key:t},{default:i((()=>[d(L,null,{default:i((()=>[c(h(e.optionLabel)+": "+h(e.optionText),1)])),_:2},1024)])),_:2},1024)))),128)),d(x,{onClick:t[3]||(t[3]=e=>V.detailVisible=!1),class:"close-button"},{default:i((()=>[c("关闭")])),_:1})])),_:1})])),_:1})):g("",!0),V.editVisible?(n(),l(P,{key:4,class:"edit-popup"},{default:i((()=>[d(P,{class:"edit-content"},{default:i((()=>[d(L,null,{default:i((()=>[c("标题:")])),_:1}),d(q,{modelValue:V.editForm.title,"onUpdate:modelValue":t[4]||(t[4]=e=>V.editForm.title=e),placeholder:"请输入标题",class:"custom-input"},null,8,["modelValue"]),(n(!0),u(p,null,r(V.editForm.options,((e,t)=>(n(),l(P,{key:t},{default:i((()=>[d(L,null,{default:i((()=>[c("选项"+h(e.optionLabel)+":",1)])),_:2},1024),d(q,{modelValue:V.editForm.options[t].optionText,"onUpdate:modelValue":e=>V.editForm.options[t].optionText=e,placeholder:"请输入选项"+e.optionLabel,class:"custom-input"},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1024)))),128)),d(L,null,{default:i((()=>[c("题型:")])),_:1}),f(k("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>V.editForm.questionType=e),onChange:t[6]||(t[6]=(...e)=>D.handleQuestionTypeChange&&D.handleQuestionTypeChange(...e))},[k("option",{value:"单选题"},"单选题"),k("option",{value:"多选题"},"多选题")],544),[[C,V.editForm.questionType]]),d(L,null,{default:i((()=>[c("正确答案:")])),_:1}),d(v,{onChange:D.handleCheckboxChange},{default:i((()=>[(n(!0),u(p,null,r(V.editForm.options,((e,t)=>(n(),l(I,{key:t,value:e.optionLabel,checked:V.selectedChoices.includes(e.optionLabel)},{default:i((()=>[c(h(e.optionLabel),1)])),_:2},1032,["value","checked"])))),128))])),_:1},8,["onChange"]),d(L,null,{default:i((()=>[c("分类:")])),_:1}),d(q,{modelValue:V.editForm.category,"onUpdate:modelValue":t[7]||(t[7]=e=>V.editForm.category=e),placeholder:"请输入分类",class:"custom-input"},null,8,["modelValue"]),d(L,null,{default:i((()=>[c("笔记:")])),_:1}),d(q,{modelValue:V.editForm.note,"onUpdate:modelValue":t[8]||(t[8]=e=>V.editForm.note=e),placeholder:"请输入笔记",class:"custom-input"},null,8,["modelValue"]),d(L,null,{default:i((()=>[c("状态:")])),_:1}),f(k("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>V.editForm.status=e)},[k("option",{value:"0"},"禁用"),k("option",{value:"1"},"启用")],512),[[C,V.editForm.status]]),d(x,{onClick:D.updateItem,class:"update-button"},{default:i((()=>[c("确认修改")])),_:1},8,["onClick"]),d(x,{onClick:D.clearForm,class:"clear-button"},{default:i((()=>[c("清空")])),_:1},8,["onClick"]),d(x,{onClick:t[10]||(t[10]=e=>V.editVisible=!1),class:"close-button"},{default:i((()=>[c("关闭")])),_:1})])),_:1})])),_:1})):g("",!0)])),_:1})}],["__scopeId","data-v-9e035d88"]]);export{D as default};
