import{s as e,r as s,a,b as o,c as l,d as t,w as r,i as d,o as n,e as i,f as p,g as c,h as u,I as m,j as w}from"./index-iGyM-cqh.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=h({data:()=>({form:{username:"",password:""},passwordType:"password",loading:!1,showRegisterPopup:!1,showChangePasswordPopup:!1,registerForm:{username:"",password:"",email:""},changePasswordForm:{username:"",oldPassword:"",newPassword:""}}),methods:{togglePwd(){this.passwordType="password"===this.passwordType?"text":"password"},handleSubmit(){this.form.username&&this.form.password?(this.loading=!0,s({url:"http://localhost:9192/user/login",method:"POST",data:{username:this.form.username,password:this.form.password},success:s=>{1===s.data.code?(e({title:"登录成功",icon:"success"}),a("token",s.data.data),o({url:"/pages/index/index"})):e({title:s.data.msg||"登录失败",icon:"none"})},fail:()=>{e({title:"网络错误，请稍后重试",icon:"none"})},complete:()=>{this.loading=!1}})):e({title:"用户名和密码不能为空",icon:"none"})},showRegister(){this.showRegisterPopup=!0},closeRegister(){this.showRegisterPopup=!1},handleRegister(){const{username:a,password:o,email:l}=this.registerForm;a&&o&&l?s({url:"http://localhost:9192/user/register",method:"POST",data:{username:a,password:o,email:l},success:s=>{1===s.data.code?(e({title:"注册成功",icon:"success"}),this.closeRegister()):e({title:s.data.msg||"注册失败",icon:"none"})},fail:()=>{e({title:"网络错误，请稍后重试",icon:"none"})}}):e({title:"所有字段都是必填项",icon:"none"})},showChangePassword(){this.showChangePasswordPopup=!0},closeChangePassword(){this.showChangePasswordPopup=!1},handleChangePassword(){const{username:a,oldPassword:o,newPassword:l}=this.changePasswordForm;a&&o&&l?s({url:"http://localhost:9192/user/updatePassword",method:"PUT",data:{username:a,oldPassword:o,newPassword:l},success:s=>{1===s.data.code?(e({title:"密码修改成功",icon:"success"}),this.closeChangePassword()):e({title:s.data.msg||"密码修改失败",icon:"none"})},fail:()=>{e({title:"网络错误，请稍后重试",icon:"none"})}}):e({title:"所有字段都是必填项",icon:"none"})}}},[["render",function(e,s,a,o,h,g){const f=u,P=d,C=l("uni-icons"),_=m,V=w;return n(),t(P,{class:"login-container"},{default:r((()=>[i(P,{class:"title-container"},{default:r((()=>[i(f,{class:"title"},{default:r((()=>[p("智能学习辅助系统")])),_:1})])),_:1}),i(P,{class:"form-item"},{default:r((()=>[i(P,{class:"svg-container"},{default:r((()=>[i(C,{type:"person",size:"20",color:"#889aa4"})])),_:1}),i(_,{modelValue:h.form.username,"onUpdate:modelValue":s[0]||(s[0]=e=>h.form.username=e),class:"input",placeholder:"请输入用户名",type:"text"},null,8,["modelValue"]),i(P,{class:"show-pwd"})])),_:1}),i(P,{class:"form-item"},{default:r((()=>[i(P,{class:"svg-container"},{default:r((()=>[i(C,{type:"locked",size:"20",color:"#889aa4"})])),_:1}),i(_,{modelValue:h.form.password,"onUpdate:modelValue":s[1]||(s[1]=e=>h.form.password=e),class:"input",type:h.passwordType,placeholder:"请输入密码"},null,8,["modelValue","type"]),i(P,{class:"show-pwd",onClick:g.togglePwd},{default:r((()=>[i(C,{type:"password"===h.passwordType?"eye":"eye-filled",size:"20",color:"#889aa4"},null,8,["type"])])),_:1},8,["onClick"])])),_:1}),i(V,{class:"login-btn",loading:h.loading,onClick:g.handleSubmit},{default:r((()=>[p(" 登录 ")])),_:1},8,["loading","onClick"]),i(P,{class:"link-container"},{default:r((()=>[i(f,{class:"link-text",onClick:g.showRegister},{default:r((()=>[p("注册")])),_:1},8,["onClick"]),i(f,{class:"link-text",onClick:g.showChangePassword,style:{"margin-left":"10px"}},{default:r((()=>[p("修改密码")])),_:1},8,["onClick"])])),_:1}),h.showRegisterPopup?(n(),t(P,{key:0,class:"popup-overlay"},{default:r((()=>[i(P,{class:"popup-container"},{default:r((()=>[i(P,{class:"popup-title"},{default:r((()=>[p("注册")])),_:1}),i(_,{modelValue:h.registerForm.username,"onUpdate:modelValue":s[2]||(s[2]=e=>h.registerForm.username=e),placeholder:"用户名",class:"popup-input"},null,8,["modelValue"]),i(_,{modelValue:h.registerForm.password,"onUpdate:modelValue":s[3]||(s[3]=e=>h.registerForm.password=e),placeholder:"密码",class:"popup-input",type:"password"},null,8,["modelValue"]),i(_,{modelValue:h.registerForm.email,"onUpdate:modelValue":s[4]||(s[4]=e=>h.registerForm.email=e),placeholder:"邮箱",class:"popup-input",type:"email"},null,8,["modelValue"]),i(V,{class:"register-btn",onClick:g.handleRegister},{default:r((()=>[p("注册")])),_:1},8,["onClick"]),i(P,{class:"close-btn",onClick:g.closeRegister},{default:r((()=>[p("×")])),_:1},8,["onClick"])])),_:1})])),_:1})):c("",!0),h.showChangePasswordPopup?(n(),t(P,{key:1,class:"popup-overlay"},{default:r((()=>[i(P,{class:"popup-container"},{default:r((()=>[i(P,{class:"popup-title"},{default:r((()=>[p("修改密码")])),_:1}),i(_,{modelValue:h.changePasswordForm.username,"onUpdate:modelValue":s[5]||(s[5]=e=>h.changePasswordForm.username=e),placeholder:"用户名",class:"popup-input"},null,8,["modelValue"]),i(_,{modelValue:h.changePasswordForm.oldPassword,"onUpdate:modelValue":s[6]||(s[6]=e=>h.changePasswordForm.oldPassword=e),placeholder:"旧密码",class:"popup-input",type:"password"},null,8,["modelValue"]),i(_,{modelValue:h.changePasswordForm.newPassword,"onUpdate:modelValue":s[7]||(s[7]=e=>h.changePasswordForm.newPassword=e),placeholder:"新密码",class:"popup-input",type:"password"},null,8,["modelValue"]),i(V,{class:"register-btn",onClick:g.handleChangePassword},{default:r((()=>[p("修改密码")])),_:1},8,["onClick"]),i(P,{class:"close-btn",onClick:g.closeChangePassword},{default:r((()=>[p("×")])),_:1},8,["onClick"])])),_:1})])),_:1})):c("",!0)])),_:1})}],["__scopeId","data-v-4886c785"]]);export{g as default};
