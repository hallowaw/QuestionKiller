import{k as e,r as o,s as t,l as i,D as s,e as l,w as n,p as r,g as a,E as d,G as c,F as u,m as h,v as p,I as m,A as g,j as f,x as C,o as k,f as y,t as v,d as T,u as x}from"./index-iGyM-cqh.js";import{_ as B}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=B({data:()=>({title:"",questionType:"单选题",category:"默认分类",note:"",options:[{optionText:""},{optionText:""}],correctChoiceSingle:"A",correctChoiceMulti:[],selectedWordBookId:null,wordBooks:[],token:e("token")}),methods:{validateTitle(){this.title.length>50&&console.warn("标题超过最大长度")},addOption(){this.options.length<10&&this.options.push({optionText:""})},onMultipleChoiceChange(e){this.correctChoiceMulti=e.detail.value},removeOption(e){this.options.length>2?this.options.splice(e,1):alert("至少需要两个选项！"),this.resetCorrectAnswers()},resetCorrectAnswers(){this.correctChoiceSingle="A",this.correctChoiceMulti=[]},resetForm(){this.title="",this.questionType="单选题",this.category="默认分类",this.note="",this.options=[{optionText:""},{optionText:""}],this.correctChoiceSingle="A",this.correctChoiceMulti=[],this.selectedWordBookId=this.wordBooks.length>0?this.wordBooks[0].id:null},fetchWordBooks(){o({url:"http://localhost:9192/user/getDefaultWordBookIdByCurrentID",method:"GET",header:{token:this.token},success:e=>{const t=e.data.data;o({url:"http://localhost:9192/wordBook/getWordBookByUserId",method:"GET",header:{token:this.token},success:e=>{this.wordBooks=e.data.data,this.selectedWordBookId=t}})}})},submitForm(){if(!this.title)return void t({title:"标题不能为空！",icon:"none"});if(this.options.some((e=>!e.optionText.trim())))return void t({title:"选项内容不能为空！",icon:"none"});let e="";if("单选题"===this.questionType){if(!this.correctChoiceSingle)return void t({title:"请选择正确答案！",icon:"none"});e=this.correctChoiceSingle}else if("多选题"===this.questionType){if(!Array.isArray(this.correctChoiceMulti)||this.correctChoiceMulti.length<2)return void t({title:"多选题至少需要两个正确答案！！",icon:"none"});e=this.correctChoiceMulti.join(",")}const i={title:this.title,questionType:this.questionType,category:this.category,correctChoice:e,note:this.note,wordBookId:this.selectedWordBookId,status:1,options:this.options.map(((e,o)=>({optionLabel:String.fromCharCode(65+o),optionText:e.optionText})))};console.log("提交前的数据:",i),o({url:"http://localhost:9192/question/add",method:"POST",header:{token:this.token},data:i,success:e=>{1===e.data.code?(t({title:"提交成功！",icon:"success"}),this.resetForm()):t({title:`提交失败：${e.data.msg}`,icon:"none"})},fail:e=>{t({title:"提交失败，请检查网络连接！",icon:"none"}),console.error(e)}})}},mounted(){this.fetchWordBooks()}},[["render",function(e,o,t,B,_,w){const V=p,b=m,S=g,q=f,I=x,A=C;return k(),i("div",{class:"add-question-form"},[s("div",{class:"form-group"},[l(V,{for:"title"},{default:n((()=>[y("标题")])),_:1}),l(b,{modelValue:_.title,"onUpdate:modelValue":o[0]||(o[0]=e=>_.title=e),id:"title",type:"text",maxlength:"50",class:r({"error-border":_.title.length>50}),onInput:w.validateTitle},null,8,["modelValue","class","onInput"]),_.title.length>50?(k(),i("p",{key:0,class:"error-text"},"标题不能超过 50 字符")):a("",!0)]),s("div",{class:"form-group"},[l(V,{for:"questionType"},{default:n((()=>[y("题型")])),_:1}),d(s("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>_.questionType=e),id:"questionType",onChange:o[2]||(o[2]=(...e)=>w.resetCorrectAnswers&&w.resetCorrectAnswers(...e))},[s("option",{value:"单选题"},"单选题"),s("option",{value:"多选题"},"多选题")],544),[[c,_.questionType]])]),s("div",{class:"form-group"},[l(V,{for:"category"},{default:n((()=>[y("分类")])),_:1}),l(b,{modelValue:_.category,"onUpdate:modelValue":o[3]||(o[3]=e=>_.category=e),id:"category",type:"text",placeholder:"默认分类"},null,8,["modelValue"])]),s("div",{class:"form-group"},[l(V,{for:"note"},{default:n((()=>[y("备注")])),_:1}),l(S,{modelValue:_.note,"onUpdate:modelValue":o[4]||(o[4]=e=>_.note=e),id:"note",rows:"3"},null,8,["modelValue"])]),s("div",{class:"form-group"},[l(V,null,{default:n((()=>[y("选项")])),_:1}),(k(!0),i(u,null,h(_.options,((e,o)=>(k(),i("div",{key:o,class:"option-item"},[s("span",{class:"option-label"},v(String.fromCharCode(65+o))+".",1),l(b,{modelValue:e.optionText,"onUpdate:modelValue":o=>e.optionText=o,type:"text",placeholder:"选项文字"},null,8,["modelValue","onUpdate:modelValue"]),l(q,{class:"delete-btn",onClick:e=>w.removeOption(o)},{default:n((()=>[y("删除")])),_:2},1032,["onClick"])])))),128)),_.options.length>=10?(k(),i("p",{key:0,class:"error-text"},"最多只能添加 10 个选项")):a("",!0),l(q,{class:"add-btn",onClick:w.addOption,disabled:_.options.length>=10},{default:n((()=>[y(" 增加选项 ")])),_:1},8,["onClick","disabled"])]),s("div",{class:"form-group"},[l(V,null,{default:n((()=>[y("正确答案区")])),_:1}),"单选题"===_.questionType?(k(),i("div",{key:0},[d(s("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>_.correctChoiceSingle=e)},[(k(!0),i(u,null,h(_.options,((e,o)=>(k(),i("option",{key:o,value:String.fromCharCode(65+o)},v(String.fromCharCode(65+o)),9,["value"])))),128))],512),[[c,_.correctChoiceSingle]])])):"多选题"===_.questionType?(k(),i("div",{key:1},[l(A,{onChange:w.onMultipleChoiceChange},{default:n((()=>[(k(!0),i(u,null,h(_.options,((e,o)=>(k(),T(V,{key:o,class:"checkbox-item"},{default:n((()=>[l(I,{value:String.fromCharCode(65+o),checked:_.correctChoiceMulti.includes(String.fromCharCode(65+o))},null,8,["value","checked"]),y(" "+v(String.fromCharCode(65+o)),1)])),_:2},1024)))),128))])),_:1},8,["onChange"])])):a("",!0)]),s("div",{class:"form-group"},[l(V,{for:"wordBook"},{default:n((()=>[y("关联词书")])),_:1}),d(s("select",{"onUpdate:modelValue":o[6]||(o[6]=e=>_.selectedWordBookId=e),id:"wordBook"},[(k(!0),i(u,null,h(_.wordBooks,(e=>(k(),i("option",{key:e.id,value:e.id},v(e.name),9,["value"])))),128))],512),[[c,_.selectedWordBookId]])]),s("div",{class:"form-group buttons"},[l(q,{class:"submit-btn",onClick:w.submitForm},{default:n((()=>[y("提交")])),_:1},8,["onClick"]),l(q,{class:"reset-btn",onClick:w.resetForm},{default:n((()=>[y("重置")])),_:1},8,["onClick"])])])}],["__scopeId","data-v-bcc73fe2"]]);export{_ as default};
